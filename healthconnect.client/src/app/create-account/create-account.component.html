<div class="login-container">
  <div class="logo-section">
    <div class="logo-content">
      <h2>Join Your</h2>
      <h2>Healthcare Companion</h2>
      <p class="tagline">Health, Just a Click Away!</p>
      <img class="logo_nobg" src="../../assets/logos/icononly_transparent_nobuffer.png" />
    </div>
  </div>

  <div class="login-section">
    <div class="login-content-wrapper">
      <div class="login-content">
        <h1>Create Account</h1>
        <p>Please use your academic details to register</p>

        <form [formGroup]="createAccountForm" (ngSubmit)="onSubmit()" class="login-form">
          <!-- Success Message -->
          <div class="success-message" *ngIf="showSuccessMessage">
            <div class="success-content">
              <span class="success-icon">âœ“</span>
              <p>Account created successfully! Redirecting to login...</p>
            </div>
          </div>

          <!-- First Name -->
          <div class="form-group">
            <label for="firstName">First Name</label>
            <input type="text"
                   id="firstName"
                   formControlName="firstName"
                   placeholder="Enter your first name"
                   class="form-control"
                   [class.error]="createAccountForm.get('firstName')?.invalid && createAccountForm.get('firstName')?.touched">

            <div class="validation-error" *ngIf="createAccountForm.get('firstName')?.invalid && createAccountForm.get('firstName')?.touched">
              <span *ngIf="createAccountForm.get('firstName')?.errors?.['required']">First name is required</span>
              <span *ngIf="createAccountForm.get('firstName')?.errors?.['pattern']">First name can only contain letters</span>
            </div>
          </div>

          <!-- Last Name -->
          <div class="form-group">
            <label for="lastName">Last Name</label>
            <input type="text"
                   id="lastName"
                   formControlName="lastName"
                   placeholder="Enter your last name"
                   class="form-control"
                   [class.error]="createAccountForm.get('lastName')?.invalid && createAccountForm.get('lastName')?.touched">

            <div class="validation-error" *ngIf="createAccountForm.get('lastName')?.invalid && createAccountForm.get('lastName')?.touched">
              <span *ngIf="createAccountForm.get('lastName')?.errors?.['required']">Last name is required</span>
              <span *ngIf="createAccountForm.get('lastName')?.errors?.['pattern']">Last name can only contain letters</span>
            </div>
          </div>


          <!-- Email Field -->
          <div class="form-group">
            <label for="email">Academic Email</label>
            <input type="email"
                   id="email"
                   formControlName="email"
                   placeholder="s123456789@mandela.ac.za"
                   class="form-control"
                   [class.error]="createAccountForm.get('email')?.invalid && createAccountForm.get('email')?.touched">

            <div class="validation-error" *ngIf="createAccountForm.get('email')?.invalid && createAccountForm.get('email')?.touched">
              <span *ngIf="createAccountForm.get('email')?.errors?.['required']">Email is required</span>
              <span *ngIf="createAccountForm.get('email')?.errors?.['invalidAcademicEmail']">Please enter a valid academic email</span>
            </div>
          </div>

          <!-- Cellphone Number -->
          <div class="form-group">
            <label for="cellphone">Cellphone Number</label>
            <input type="tel"
                   id="cellphone"
                   formControlName="cellphone"
                   placeholder="e.g., 0712345678"
                   class="form-control"
                   [class.error]="createAccountForm.get('cellphone')?.invalid && createAccountForm.get('cellphone')?.touched">

            <div class="validation-error" *ngIf="createAccountForm.get('cellphone')?.invalid && createAccountForm.get('cellphone')?.touched">
              <span *ngIf="createAccountForm.get('cellphone')?.errors?.['required']">Cellphone number is required</span>
              <span *ngIf="createAccountForm.get('cellphone')?.errors?.['pattern']">Please enter a valid South African cellphone number (e.g., 0712345678)</span>
            </div>
          </div>

          <!-- Campus Selection -->
          <div class="form-group">
            <label for="campus">Campus</label>
            <select id="campus"
                    formControlName="campus"
                    class="form-control"
                    [class.error]="createAccountForm.get('campus')?.invalid && createAccountForm.get('campus')?.touched">
              <option value="" disabled>Select your campus</option>
              <option>North Campus</option>
              <option>South Campus</option>
              <option>Missionvale Campus</option>
              <option>George Campus</option>
              <option>Second Avenue Campus</option>
              <option>Bird Street Campus</option>
            </select>

            <div class="validation-error" *ngIf="createAccountForm.get('campus')?.invalid && createAccountForm.get('campus')?.touched">
              <span *ngIf="createAccountForm.get('campus')?.errors?.['required']">Please select your campus</span>
            </div>
          </div>

          <!-- Course Selection with Autocomplete -->
          <div class="form-group">
            <label for="course">Course</label>
            <input type="text"
                   id="course"
                   formControlName="course"
                   placeholder="Start typing your course..."
                   class="form-control"
                   [class.error]="createAccountForm.get('course')?.invalid && createAccountForm.get('course')?.touched"
                   (input)="filterCourses()"
                   (focus)="showCourseDropdown = true"
                   (blur)="onCourseBlur()">

            <!-- Course Dropdown -->
            <div class="autocomplete-dropdown" *ngIf="showCourseDropdown && filteredCourses.length > 0">
              <div class="dropdown-list">
                <div *ngFor="let course of filteredCourses"
                     class="dropdown-item"
                     (mousedown)="selectCourse(course)">
                  {{ course }}
                </div>
              </div>
            </div>

            <div class="validation-error" *ngIf="createAccountForm.get('course')?.invalid && createAccountForm.get('course')?.touched">
              <span *ngIf="createAccountForm.get('course')?.errors?.['required']">Course is required</span>
              <span *ngIf="createAccountForm.get('course')?.errors?.['invalidCourse']">Please select a valid course from the list</span>
            </div>
          </div>

          <!-- Password Field -->
          <div class="form-group">
            <label for="password">Password</label>
            <input type="password"
                   id="password"
                   formControlName="password"
                   placeholder="Create a strong password"
                   class="form-control"
                   [class.error]="createAccountForm.get('password')?.invalid && createAccountForm.get('password')?.touched">

            <!-- Password Requirements -->
            <div class="password-requirements" *ngIf="createAccountForm.get('password')?.value">
              <p class="requirements-title">Password requirements:</p>
              <ul class="requirements-list">
                <li [class.requirement-met]="passwordRequirements.minLength" [class.requirement-unmet]="!passwordRequirements.minLength">
                  <span class="requirement-icon">{{ passwordRequirements.minLength ? 'âœ“' : 'â—‹' }}</span>
                  At least 8 characters
                </li>
                <li [class.requirement-met]="passwordRequirements.hasUpperCase" [class.requirement-unmet]="!passwordRequirements.hasUpperCase">
                  <span class="requirement-icon">{{ passwordRequirements.hasUpperCase ? 'âœ“' : 'â—‹' }}</span>
                  One uppercase letter (A-Z)
                </li>
                <li [class.requirement-met]="passwordRequirements.hasLowerCase" [class.requirement-unmet]="!passwordRequirements.hasLowerCase">
                  <span class="requirement-icon">{{ passwordRequirements.hasLowerCase ? 'âœ“' : 'â—‹' }}</span>
                  One lowercase letter (a-z)
                </li>
                <li [class.requirement-met]="passwordRequirements.hasNumber" [class.requirement-unmet]="!passwordRequirements.hasNumber">
                  <span class="requirement-icon">{{ passwordRequirements.hasNumber ? 'âœ“' : 'â—‹' }}</span>
                  One number (0-9)
                </li>
                <li [class.requirement-recommended]="true">
                  <span class="requirement-icon">ðŸ’¡</span>
                  One special character (recommended)
                </li>
              </ul>
            </div>

            <div class="validation-error" *ngIf="createAccountForm.get('password')?.invalid && createAccountForm.get('password')?.touched">
              <span *ngIf="createAccountForm.get('password')?.errors?.['required']">Password is required</span>
              <span *ngIf="createAccountForm.get('password')?.errors?.['minlength']">Password must be at least 8 characters</span>
              <span *ngIf="createAccountForm.get('password')?.errors?.['missingUpperCase']">Password must contain at least one uppercase letter</span>
              <span *ngIf="createAccountForm.get('password')?.errors?.['missingLowerCase']">Password must contain at least one lowercase letter</span>
              <span *ngIf="createAccountForm.get('password')?.errors?.['missingNumber']">Password must contain at least one number</span>
            </div>
          </div>

          <!-- Confirm Password Field -->
          <div class="form-group">
            <label for="confirmPassword">Confirm Password</label>
            <input type="password"
                   id="confirmPassword"
                   formControlName="confirmPassword"
                   placeholder="Confirm your password"
                   class="form-control"
                   [class.error]="createAccountForm.get('confirmPassword')?.invalid && createAccountForm.get('confirmPassword')?.touched">

            <div class="validation-error" *ngIf="createAccountForm.get('confirmPassword')?.invalid && createAccountForm.get('confirmPassword')?.touched">
              <span *ngIf="createAccountForm.get('confirmPassword')?.errors?.['required']">Please confirm your password</span>
              <span *ngIf="createAccountForm.get('confirmPassword')?.errors?.['passwordMismatch']">Passwords do not match</span>
            </div>
          </div>

          <!-- Terms and Conditions -->
          <div class="form-group terms-section">
            <label class="toggle">
              <input type="checkbox" formControlName="termsAccepted" name="termsAccepted">
              <span>
                I agree to the
                <a href="#" (click)="navigateToTerms(); $event.preventDefault()" class="terms-link">
                  Terms and Conditions
                </a>
                and
                <a href="#" class="terms-link" (click)="navigateToPrivacyPolicy(); $event.preventDefault()">
                  Privacy Policy
                </a>
              </span>
            </label>
            <div class="validation-error" *ngIf="createAccountForm.get('termsAccepted')?.invalid && createAccountForm.get('termsAccepted')?.touched">
              <span *ngIf="createAccountForm.get('termsAccepted')?.errors?.['required']">You must accept the terms and conditions</span>
            </div>
          </div>

          <!-- Create Account Button -->
          <button type="submit"
                  class="signin-button"
                  [disabled]="isLoading">
            <span *ngIf="!isLoading">CREATE ACCOUNT</span>
            <span *ngIf="isLoading">Creating Account...</span>
          </button>

          <!-- Back to Login -->
          <div class="create-account-section">
            <p class="create-account-text">
              Already have an account?
              <a href="#" (click)="navigateToLogin(); $event.preventDefault()" class="create-account-link">
                Sign In
              </a>
            </p>
          </div>
        </form>
      </div>
    </div>

    <!-- Disclaimer Section -->
    <div class="disclaimer-section">
      <h3>Disclaimer</h3>
      <p>
        All parties agree that they will comply with POPI regulations and process all the information
        and/or personal data in respect of the services being rendered in accordance with the said regulations.
      </p>
      <p>
        It is confirmed that by submitting information to Madiba HealthConnect, irrespective as to how
        such information is submitted, you consent to the collection, collation, processing, and storing
        of such information and the use and disclosure of such information in accordance with this policy.
      </p>
    </div>
  </div>
</div>
