<div class="nurse-dashboard-container">
  <!-- Top Header Bar -->
  <header class="top-bar">
    <div class="header-content">
      <div class="header-main">
        <h1>Madiba HealthConnect - Nurse Portal</h1>
        <div class="header-subsection">
          <img class="header-logo" src="../../assets/logos/icononly_transparent_nobuffer.png" />
          <div class="header-titles">
            <p class="page-title">Nurse Dashboard</p>
            <p class="profile-indicator">Providing Quality Healthcare</p>
          </div>
        </div>
      </div>
    </div>

    <div class="header-avatar-container">
      <div class="header-avatar" (click)="toggleUserMenu()">
        {{ nurseInitials }}
      </div>
      <div class="user-menu" *ngIf="showUserMenu">
        <div class="user-menu-item" (click)="logout()">
          <span class="menu-icon">ðŸšª</span>
          Logout
        </div>
      </div>
    </div>
  </header>

  <!-- Nurse Profile Section -->
  <div class="profile-section">
    <div class="profile-container">
      <div class="user-avatar">
        {{ nurseInitials }}
      </div>
      <div class="user-info">
        <h3>{{ nurse?.fullName || 'Loading...' }}</h3>
        <p class="user-email">{{ nurse?.email || 'Loading...' }}</p>
        <div class="user-details">
          <p><strong>Employee Number:</strong> {{ nurse?.employeeNumber || 'N/A' }}</p>
          <p><strong>Specialization:</strong> {{ nurse?.specialization || 'N/A' }}</p>
          <p>
            <strong>Status:</strong>
            <span class="status-badge" [class.available]="nurse?.isAvailable"
                  [class.unavailable]="!nurse?.isAvailable">
              {{ nurse?.isAvailable ? 'Available' : 'Unavailable' }}
            </span>
          </p>
        </div>
      </div>
      </div>
  </div>

  <div class="dashboard-layout">
    <!-- Left Sidebar - Nurse Navigation -->
    <aside class="sidebar">
      <nav class="main-nav">
        <ul>
          <li *ngFor="let item of menuItems"
              [class.active]="item.checked"
              (click)="onMenuItemClick(item)"
              [attr.data-section]="item.id">
            <label class="menu-item">
              <div class="menu-text">
                <span class="menu-label">{{ item.label }}</span>
                <span class="menu-description">{{ item.description }}</span>
              </div>
            </label>
          </li>
        </ul>

        <!-- Logout Button -->
        <div class="logout-section">
          <button class="logout-btn" (click)="logout()">
            <span class="logout-icon">ðŸšª</span>
            <span class="logout-text">Logout</span>
          </button>
        </div>
      </nav>

      <!-- Quick Stats -->
      <div class="quick-stats">
        <div class="stat-card">
          <div class="stat-number">{{ todaysAppointments.length }}</div>
          <div class="stat-label">Today's Appointments</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">{{ pendingAppointmentsCount }}</div>
          <div class="stat-label">Pending</div>
        </div>
      </div>
    </aside>

    <!-- Main Content Area -->
    <main class="main-content">
      <!-- Today's Schedule (Default View) -->
      <section id="schedule-content" class="content-section" [class.hidden]="!isSectionActive('schedule')">
        <div class="content-card">
          <div class="card-header">
            <h2>Today's Schedule - {{ today | date:'fullDate' }}</h2>
          </div>
          <div class="card-content">
            <div class="schedule-list">
              <div *ngFor="let appointment of todaysAppointments"
                   class="appointment-item"
                   [class.completed]="appointment.status === 'Completed'"
                   [class.upcoming]="appointment.status === 'Confirmed'"
                   [class.in-progress]="appointment.status === 'InProgress'">

                <div class="appointment-time">
                  <strong>{{ appointment.timeSlot }}</strong>
                </div>

                <div class="appointment-details">
                  <div class="patient-info">
                    <strong>{{ appointment.studentName }}</strong>
                    <span class="student-id">{{ appointment.studentNumber }}</span>
                  </div>
                  <div class="appointment-type">
                    {{ appointment.consultationType }} â€¢ {{ appointment.consultationMode || 'In-Person' }}
                  </div>
                  <div class="symptoms" *ngIf="appointment.symptomsDescription">
                    {{ appointment.symptomsDescription }}
                  </div>
                </div>

                <div class="appointment-status">
                  <span class="status-badge" [class]="appointment.status.toLowerCase()">
                    {{ appointment.status }}
                  </span>
                </div>

                <div class="appointment-actions">
                  <button *ngIf="appointment.status === 'Confirmed'"
                          class="btn primary small"
                          (click)="startConsultation(appointment)">
                    Start Consultation
                  </button>

                  <button *ngIf="appointment.status === 'InProgress'"
                          class="btn success small"
                          (click)="completeConsultation(appointment)">
                    Complete
                  </button>

                  <button class="btn outline small"
                          (click)="viewAppointmentDetails(appointment)">
                    Details
                  </button>

                  <button class="btn outline small"
                          (click)="rescheduleAppointment(appointment)">
                    Reschedule
                  </button>
                </div>
              </div>

              <div *ngIf="todaysAppointments.length === 0" class="no-appointments">
                <p>No appointments scheduled for today.</p>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- All Appointments View -->
      <section id="appointments-content" class="content-section" [class.hidden]="!isSectionActive('appointments')">
        <div class="content-card">
          <div class="card-header">
            <h2>All My Appointments</h2>
            <div class="filter-controls">
              <select [(ngModel)]="appointmentFilter" (change)="filterAppointments()">
                <option value="all">All Appointments</option>
                <option value="today">Today</option>
                <option value="week">This Week</option>
                <option value="pending">Pending</option>
                <option value="completed">Completed</option>
              </select>
            </div>
          </div>
          <div class="card-content">
            <!-- Similar appointment list as schedule view but with date filtering -->
            <div class="appointment-list">
              <!-- Implementation similar to schedule view -->
            </div>
          </div>
        </div>
      </section>

      <!-- Consultation Notes View -->
      <section id="consultations-content" class="content-section" [class.hidden]="!isSectionActive('consultations')">
        <div class="content-card">
          <div class="card-header">
            <h2>Consultation Management</h2>
          </div>
          <div class="card-content">
            <div class="consultation-interface" *ngIf="activeConsultation">
              <h3>Consultation with {{ activeConsultation.studentName }}</h3>

              <div class="consultation-form">
                <div class="form-group">
                  <label for="consultationNotes">Consultation Notes</label>
                  <textarea id="consultationNotes"
                            [(ngModel)]="consultationNotes"
                            placeholder="Record observations, diagnosis, and treatment..."
                            rows="6"></textarea>
                </div>

                <div class="form-group">
                  <label for="prescription">Prescription (if any)</label>
                  <textarea id="prescription"
                            [(ngModel)]="prescription"
                            placeholder="Prescription details..."
                            rows="4"></textarea>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label class="toggle">
                      <input type="checkbox" [(ngModel)]="followUpRequired">
                      <span>Follow-up required</span>
                    </label>
                  </div>

                  <div class="form-group" *ngIf="followUpRequired">
                    <label for="followUpDate">Follow-up Date</label>
                    <input id="followUpDate" type="date" [(ngModel)]="followUpDate">
                  </div>
                </div>

                <div class="action-buttons">
                  <button class="btn success" (click)="saveConsultation()">
                    Save Consultation Notes
                  </button>
                  <button class="btn primary" (click)="completeConsultation(activeConsultation)">
                    Mark as Complete
                  </button>
                  <button class="btn outline" (click)="cancelConsultation()">
                    Cancel
                  </button>
                </div>
              </div>
            </div>

            <div *ngIf="!activeConsultation" class="no-consultation">
              <p>Select an appointment to start consultation.</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Availability Management -->
      <section id="availability-content" class="content-section" [class.hidden]="!isSectionActive('availability')">
        <div class="content-card">
          <div class="card-header">
            <h2>Manage Availability</h2>
          </div>
          <div class="card-content">
            <div class="availability-controls">
              <label class="toggle large">
                <input type="checkbox" [(ngModel)]="nurse.isAvailable" (change)="updateAvailability()">
                <span>I am available for new appointments</span>
              </label>

              <div class="working-hours">
                <h4>Working Hours</h4>
                <!-- Working hours management interface -->
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>
</div>
