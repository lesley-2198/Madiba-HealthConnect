<div class="login-container">
  <div class="logo-section">
    <div class="logo-content">
      <h2>Welcome to your</h2>
      <h2>Healthcare Companion</h2>
      <p class="tagline">Health, Just a Click Away!</p>
      <img class="logo_nobg" src="../../assets/logos/icononly_transparent_nobuffer.png" />
    </div>
  </div>

  <div class="login-section">
    <div class="login-content-wrapper">
      <div class="login-content">
        <h1>Reset Password</h1>

        <div *ngIf="!passwordReset">
          <p class="instruction">Enter your academic email and new password</p>

          <form [formGroup]="resetPasswordForm" (ngSubmit)="onSubmit()" class="login-form">
            <!-- Success Message (for form validation feedback) -->
            <div class="success-message" *ngIf="passwordReset">
              <div class="success-content">
                <span class="success-icon">✓</span>
                <p>Password reset successfully! Redirecting to login...</p>
              </div>
            </div>

            <span *ngIf="resetPasswordForm.get('password')?.errors?.['previousPassword']">
              You cannot use a previous password. Please choose a new one.
            </span>

            <!-- Email Field -->
            <div class="form-group">
              <label for="email">Academic Email</label>
              <input type="email"
                     id="email"
                     formControlName="email"
                     placeholder="example@mandela.ac.za"
                     class="form-control"
                     [class.error]="resetPasswordForm.get('email')?.invalid && resetPasswordForm.get('email')?.touched">

              <div class="validation-error" *ngIf="resetPasswordForm.get('email')?.invalid && resetPasswordForm.get('email')?.touched">
                <span *ngIf="resetPasswordForm.get('email')?.errors?.['required']">Email is required</span>
                <span *ngIf="resetPasswordForm.get('email')?.errors?.['invalidAcademicEmail']">Please enter a valid academic email</span>
                <span *ngIf="resetPasswordForm.get('email')?.errors?.['email'] && !resetPasswordForm.get('email')?.errors?.['invalidAcademicEmail']">Please enter a valid email address</span>
              </div>
            </div>

            <!-- New Password Field -->
            <div class="form-group">
              <label for="password">New Password</label>
              <input type="password"
                     id="password"
                     formControlName="password"
                     placeholder="Enter new password"
                     class="form-control"
                     [class.error]="resetPasswordForm.get('password')?.invalid && resetPasswordForm.get('password')?.touched">

              <div class="validation-error" *ngIf="resetPasswordForm.get('password')?.invalid && resetPasswordForm.get('password')?.touched">
                <span *ngIf="resetPasswordForm.get('password')?.errors?.['required']">Password is required</span>
                <span *ngIf="resetPasswordForm.get('password')?.errors?.['minlength']">Password must be at least 8 characters</span>
              </div>
            </div>

            <!-- Confirm Password Field -->
            <div class="form-group">
              <label for="confirmPassword">Confirm New Password</label>
              <input type="password"
                     id="confirmPassword"
                     formControlName="confirmPassword"
                     placeholder="Confirm new password"
                     class="form-control"
                     [class.error]="resetPasswordForm.get('confirmPassword')?.invalid && resetPasswordForm.get('confirmPassword')?.touched">

              <div class="validation-error" *ngIf="resetPasswordForm.get('confirmPassword')?.invalid && resetPasswordForm.get('confirmPassword')?.touched">
                <span *ngIf="resetPasswordForm.get('confirmPassword')?.errors?.['required']">Please confirm your password</span>
                <span *ngIf="resetPasswordForm.get('confirmPassword')?.errors?.['passwordMismatch']">Passwords do not match</span>
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="button-group">
              <button type="submit"
                      class="signin-button"
                      [disabled]="isLoading">
                <span *ngIf="!isLoading">Reset Password</span>
                <span *ngIf="isLoading">Resetting...</span>
              </button>

              <button type="button"
                      class="back-to-login-button"
                      (click)="navigateToLogin()">
                Back to Login
              </button>
            </div>
          </form>
        </div>

        <!-- Success State -->
        <div *ngIf="passwordReset" class="success-message">
          <div class="success-icon">✓</div>
          <h3>Password Reset Successfully!</h3>
          <p>Your password has been updated successfully.</p>
          <p class="check-inbox">You will be redirected to the login page shortly.</p>
        </div>
      </div>
    </div>

    <!-- Disclaimer Section -->
    <div class="disclaimer-section">
      <h3>Disclaimer</h3>
      <p>
        All parties agree that they will comply with POPI regulations and process all the information
        and/or personal data in respect of the services being rendered in accordance with the said regulations.
      </p>
      <p>
        It is confirmed that by submitting information to Madiba HealthConnect, irrespective as to how
        such information is submitted, you consent to the collection, collation, processing, and storing
        of such information and the use and disclosure of such information in accordance with this policy.
      </p>
    </div>
  </div>
</div>
